{"version":3,"sources":["Game.js"],"names":["Direction","require","BlockPool","cc","Class","extends","Component","properties","scoreLabel","default","type","Label","playPrefab","Prefab","blockPrefab","bounsPrefab","centerNode","Node","startBtn","Button","_player","_bouns","playerRadius","blockRadius","_blockPool","_isStart","_dt","_touchPosX","_touchPosY","_isMoved","_cellsTable","onLoad","score","initCellsTable","createPlayer","setTouchConstrol","node","on","onStartGame","xIndex","yIndex","i","j","index","x","y","push","forEach","log","element","instantiate","getComponent","_game","addChild","reset","createBonus","checkBonus","onCollect","addScore","string","toString","hideAllBlock","active","createBlock","gameOver","cacheAllBlock","destroy","stopAllActions","getRandom","randomRange","lastRandom","random","rand","ret","Math","round","dir","down","p","winSize","height","up","right","width","left","dirTab","first","second","createOneBlock","update","dt","startPos","speed","block","create","event","getLocationX","getLocationY","touchDistance","pDistance","getLocation","disX","disY","abs","changePos"],"mappings":"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","file":"Game.js","sourceRoot":"../../../../assets/Script","sourcesContent":["var Direction = require(\"direction\");\nvar BlockPool = require(\"BlockPool\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        scoreLabel: {\n            default: null,\n            type: cc.Label\n        },\n        \n        playPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        blockPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        bounsPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        centerNode: {\n            default: null,\n            type: cc.Node\n        },\n        startBtn: {\n            default: null,\n            type: cc.Button\n        },\n\n        _player: null,\n        _bouns: null,\n        playerRadius: 80,\n        blockRadius: 80,\n        _blockPool: null,\n        _isStart: false,\n        _dt: 0,\n\n        _touchPosX: 0,\n        _touchPosY: 0,\n        _isMoved: false,\n\n        _cellsTable:[],\n\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.score = 0;\n\n        this.initCellsTable();\n        this.createPlayer();\n        \n        this.setTouchConstrol();\n        this.startBtn.node.on(\"click\", this.onStartGame, this);\n    },\n\n    initCellsTable: function() {\n        var xIndex = [-1,0,1];\n        var yIndex = [1,0,-1];\n        for(var i = 0; i < 3; i++) {\n            for(var j = 0; j < 3; j++) {\n                var index = {x:xIndex[i], y:yIndex[j]};\n                this._cellsTable.push(index);\n            }\n        }\n        this._cellsTable.forEach(element => {\n            cc.log(\"index: %d,%d\",element.x,element.y);\n        });\n    },\n\n    createPlayer: function() {\n        if(!this._player) {\n            this._player = cc.instantiate(this.playPrefab);\n            this._player.getComponent(\"player\")._game = this;\n            this.node.addChild(this._player, 1);\n        }\n        this._player.getComponent(\"player\").reset();\n    },\n    \n    createBonus: function() {\n        this._bouns = cc.instantiate(this.bounsPrefab);\n        this._bouns.getComponent(\"Bonus\")._game = this;\n        this.node.addChild(this._bouns, 2);\n    },\n    \n    checkBonus: function() {\n        if (this._bouns) {\n            this._bouns.getComponent(\"Bonus\").onCollect();\n        }\n    },\n\n    addScore: function() {\n        this.score++;\n        this.scoreLabel.string = this.score.toString();\n    },\n\n    onStartGame: function() {\n        BlockPool.hideAllBlock();\n        this._isStart = true;\n        this._dt = 0;\n        this.startBtn.node.active = false;\n        \n        this._player.getComponent(\"player\").reset();\n        this.createBonus();\n        this.createBlock();\n    },\n\n    gameOver: function () {\n        BlockPool.cacheAllBlock();\n        this._isStart = false;\n        this.startBtn.node.active = true;\n        this.score = 0;\n        this.scoreLabel.string = \"\";\n        this._bouns.getComponent(\"Bonus\").node.destroy();\n        this._player.getComponent(\"player\").stopAllActions();\n    },\n\n    getRandom: function(randomRange, lastRandom) {\n        var random = cc.rand();\n        var ret = Math.round(random) % randomRange;\n        if(lastRandom && lastRandom == ret) {\n            return this.getRandom(randomRange, lastRandom);\n        }\n        return ret;\n    },\n\n    createBlock: function() {\n        var random = cc.rand();\n        var dir = Math.round(random) % 4;\n        var down = [cc.p(this.centerNode.x - 80,this.centerNode.y + cc.winSize.height/2 + 40),cc.p(this.centerNode.x,this.centerNode.y + cc.winSize.height/2 + 40),cc.p(this.centerNode.x + 80,this.centerNode.y + cc.winSize.height/2 + 40)];\n        var up = [cc.p(this.centerNode.x - 80,this.centerNode.y - cc.winSize.height/2 - 40),cc.p(this.centerNode.x,this.centerNode.y - cc.winSize.height/2 - 40),cc.p(this.centerNode.x + 80,this.centerNode.y - cc.winSize.height/2 - 40)];\n        var right = [cc.p(this.centerNode.x - cc.winSize.width/2 - 40,this.centerNode.y),cc.p(this.centerNode.x - cc.winSize.width/2 - 40,this.centerNode.y + 80),cc.p(this.centerNode.x - cc.winSize.width/2 - 40,this.centerNode.y - 80)];\n        var left = [cc.p(this.centerNode.x + cc.winSize.width/2 + 40,this.centerNode.y),cc.p(this.centerNode.x + cc.winSize.width/2 + 40,this.centerNode.y + 80),cc.p(this.centerNode.x + cc.winSize.width/2 + 40,this.centerNode.y - 80)];\n        var dirTab = [];\n        switch(dir){\n            case Direction.left:\n                dirTab = left;\n            break;\n            case Direction.right:\n                dirTab = right;\n            break;\n            case Direction.up:\n                dirTab = up;\n            break;\n            case Direction.down:\n                dirTab = down;\n            break;\n        }\n        var first = this.getRandom(3);\n        var second = this.getRandom(3, first);\n        this.createOneBlock(dirTab[first], 5 ,dir);\n        this.createOneBlock(dirTab[second], 5 ,dir);\n        cc.log(\"first: \" + first + \" second: \" + second);\n    },\n\n    // called every frame\n    update: function (dt) {\n        if(this._isStart == true) {\n            this._dt += dt;\n            if(this._dt >= 2) {\n                this._dt = 0;\n                this.createBlock();\n            }\n        }\n    },\n\n    createOneBlock: function(startPos, speed, dir) {\n        var block = BlockPool.createBlock(this.blockPrefab, this);\n        block.create(startPos,speed, dir, this);\n    },\n\n    setTouchConstrol: function() {\n        this.node.on('touchstart', function (event) {\n            this._touchPosX = event.getLocationX();\n            this._touchPosY = event.getLocationY();\n            this._isMoved = false;\n        }, this);\n        this.node.on('touchmove', function (event) {\n            if(this._isMoved) {\n                return;\n            }\n            var touchDistance = cc.pDistance(cc.p(this._touchPosX,this._touchPosY), event.getLocation());\n            var disX = event.getLocationX() - this._touchPosX;\n            var disY = event.getLocationY() - this._touchPosY;\n            var dir = -1;\n            if(touchDistance >= 10) {\n                if(disX > 0 && disY > 0) {\n                    if(disX > disY) {\n                        dir = Direction.right;\n                    } else {\n                        dir = Direction.up;\n                    }\n                } else if (disX > 0 && disY < 0) {\n                    if(Math.abs(disX) > Math.abs(disY)) {\n                        dir = Direction.right;\n                    } else {\n                        dir = Direction.down;\n                    }\n                } else if(disX < 0 && disY < 0) {\n                    if(Math.abs(disX) > Math.abs(disY)) {\n                        dir = Direction.left;\n                    } else {\n                        dir = Direction.down;\n                    }\n                } else if(disX < 0 && disY > 0) {\n                    if(Math.abs(disX) > Math.abs(disY)) {\n                        dir = Direction.left;\n                    } else {\n                        dir = Direction.up;\n                    }\n                } else if(disX == 0 && disY > 0) {\n                    dir = Direction.up;\n                } else if(disX == 0 && disY < 0) {\n                    dir = Direction.down;\n                } else if(disX > 0 && disY == 0) {\n                    dir = Direction.right;\n                } else if(disX < 0 && disY == 0) {\n                    dir = Direction.left;\n                }\n                this._player.getComponent('player').changePos(dir);\n                this._isMoved = true;\n            }\n        }, this);\n    }\n});\n"]}